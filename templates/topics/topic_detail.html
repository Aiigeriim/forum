{% extends 'base.html' %}

{% block title %}
{% endblock %}

{% block content %}
    <div class="card text-center">
        <div class="card-body">
            <h5 class="card-title">{{ topic.topic }}</h5>
            <p class="card-text">{{ topic.content}}</p>
            <p class="text-body-secondary">{{ topic.created_at }}</p>
            <a href="{% url 'accounts:profile' topic.author.pk %}"><p class="text-body-secondary">{{ topic.author }}</p></a>
            {% if perms.webapp.change_topic or request.user == topic.author %}
                <a href="{% url 'webapp:topic_delete' topic.pk %}" title="Удалить тему" ><i class="bi bi-trash3"></i></a>
            {% endif %}
            {% if perms.webapp.delete_topic or request.user == topic.author %}
                <a href="{% url 'webapp:topic_update' topic.pk %}" title="Редактировать тему"><i class="bi bi-pencil"></i></a>
            {% endif %}
        </div>
    </div>

{#    <form action="">#}
{#        {% include 'partial/form.html' with btn_text='Добавить'%}#}
{#    </form>#}


    <div class="container mt-3">
        {% if user.is_authenticated %}
            <form method="post" action="{% url 'webapp:add_answer' topic.pk %}">
                {% csrf_token %}
                {{ answer_form.as_p }}
                <button type="submit" class="btn btn-primary">Ответить</button>
            </form>
        {% endif %}
        <div class="list-group mt-3">
            {% for answer in object_list %}
                <div class="card mb-3" style="max-width: 540px;">
                    <div class="row g-0">
                        <div class="col-md-4">
                            <img src="{{ answer.author.avatar.url }}" class="img-fluid rounded-start" alt="...">
                        </div>
                        <div class="col-md-8">
                            <div class="card-body">
                                <a href="{% url 'accounts:profile' answer.author.pk %}"><h5 class="card-title">{{ answer.author }}</h5></a>
                                <p class="card-text">{{ answer.answer }}</p>
                                <p class="card-text"><small class="text-body-secondary">{{ answer.created_at }}</small></p>
                                {% if perms.webapp.change_answer or request.user == answer.author %}
                                    <a href="{% url 'webapp:update_answer' answer.pk %}" title="Редактировать"><i class="bi bi-pencil"></i></a>
                                {% endif %}
                                {% if perms.webapp.delete_answer or request.user == answer.author %}
                                    <a href="{% url 'webapp:delete_answer' answer.pk %}" title="Удалить"><i class="bi bi-trash3"></i></a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

            {% empty %}
                Ответов пока нет
            {% endfor %}
        {%  if is_paginated %}
                {% include 'partial/pagination.html' %}
        {% endif %}
        </div>
    </div>

{% endblock %}